Architecture
============

After [installing hoodie](../guides/quickstart), `npm start` will run
[cli/index.js](https://github.com/hoodiehq/hoodie/blob/master/cli/index.js)
which reads out the [configuration](../guides/configuration) from all
the different places using the [rc](https://www.npmjs.com/package/rc)
package, then passes it as options to `server/index.js`, the Hoodie core
[hapi plugin](http://hapijs.com).

In
[server/index.js](https://github.com/hoodiehq/hoodie/blob/master/server/index.js),
the passed options are merged with defaults and parsed into
configuration for the Hapi server. It passes the configuration on
to[hoodie-server](https://github.com/hoodiehq/hoodie-server#readme),
which combines the core server modules. It also bundles the Hoodie
client on first request to `/hoodie/client.js` and passes in the
configuration for the client. It also makes the app’s `public` folder
accessible at the `/` root path, and Hoodie’s Core UIs at
`/hoodie/admin`, `/hoodie/account` and `/hoodie/store`.

Hoodie uses [CouchDB](https://couchdb.apache.org/) for data persistence.
If `options.dbUrl` is not set, it falls back to
[PouchDB](https://pouchdb.com/).

Once all configuration is taken care of, the internal plugins are
initialised (see
[server/plugins/index.js](https://github.com/hoodiehq/hoodie/blob/master/server/plugins/index.js)).
We define simple Hapi plugins for
[logging](https://github.com/hoodiehq/hoodie/blob/master/server/plugins/logger.js)
and for [serving the app’s public assets and the Hoodie
client](https://github.com/hoodiehq/hoodie/blob/master/server/plugins/public.js).

Once everything is setup, the server is then started at the end of
[cli/start.js](https://github.com/hoodiehq/hoodie/blob/master/cli/index.js)
and the URL where hoodie is running is logged to the terminal.

Modules
-------

Hoodie is a server built on top of [hapi](http://hapijs.com) with
frontend APIs for account and store related tasks. It is split up in
many small modules with the goal to lower the barrier to new code
contributors and to share maintenance responsibilities.

1.  server [![server
    repository](https://assets-cdn.github.com/images/icons/emoji/octocat.png)](https://github.com/hoodiehq/hoodie-server#readme)
    [![server build
    status](https://travis-ci.org/hoodiehq/hoodie-server.svg?branch=master)](https://travis-ci.org/hoodiehq/hoodie-server)
    [![server coverage
    status](https://coveralls.io/repos/hoodiehq/hoodie-server/badge.svg?branch=master)](https://coveralls.io/r/hoodiehq/hoodie-server?branch=master)
    [![server dependency
    status](https://david-dm.org/hoodiehq/hoodie-server.svg)](https://david-dm.org/hoodiehq/hoodie-server)

    > Hoodie’s core server logic as hapi plugin. It integrates Hoodie’s
    > server core modules:
    > [account-server](https://github.com/hoodiehq/hoodie-account-server),
    > [store-server](https://github.com/hoodiehq/hoodie-store-server)
    >
    > 1.  account-server [![account-server
    >     repository](https://assets-cdn.github.com/images/icons/emoji/octocat.png)](https://github.com/hoodiehq/hoodie-account-server#readme)
    >     [![account-server build
    >     status](https://api.travis-ci.org/hoodiehq/hoodie-account-server.svg?branch=master)](https://travis-ci.org/hoodiehq/hoodie-account-server)
    >     [![account-server coverage
    >     status](https://coveralls.io/repos/hoodiehq/hoodie-account-server/badge.svg?branch=master)](https://coveralls.io/r/hoodiehq/hoodie-account-server?branch=master)
    >     [![account-server dependency
    >     status](https://david-dm.org/hoodiehq/hoodie-account-server.svg)](https://david-dm.org/hoodiehq/hoodie-account-server)
    >
    >     > [Hapi](http://hapijs.com/) plugin that implements the
    >     > [Account JSON API](http://docs.accountjsonapi.apiary.io)
    >     > routes and exposes a corresponding API at
    >     > `server.plugins.account.api.*`.
    >
    > 2.  store-server [![store-server
    >     repository](https://assets-cdn.github.com/images/icons/emoji/octocat.png)](https://github.com/hoodiehq/hoodie-store-server#readme)
    >     [![store-server build
    >     status](https://travis-ci.org/hoodiehq/hoodie-store-server.svg?branch=master)](https://travis-ci.org/hoodiehq/hoodie-store-server)
    >     [![store-server coverage
    >     status](https://coveralls.io/repos/hoodiehq/hoodie-store-server/badge.svg?branch=master)](https://coveralls.io/r/hoodiehq/hoodie-store-server?branch=master)
    >     [![store-server dependency
    >     status](https://david-dm.org/hoodiehq/hoodie-store-server.svg)](https://david-dm.org/hoodiehq/hoodie-store-server)
    >
    >     > [Hapi](http://hapijs.com/) plugin that implements [CouchDB’s
    >     > Document
    >     > API](https://wiki.apache.org/couchdb/HTTP_Document_API).
    >     > Compatible with [CouchDB](https://couchdb.apache.org/) and
    >     > [PouchDB](https://pouchdb.com/) for persistence.
    >
2.  client [![client
    repository](https://assets-cdn.github.com/images/icons/emoji/octocat.png)](https://github.com/hoodiehq/hoodie-client#readme)
    [![client build
    status](https://travis-ci.org/hoodiehq/hoodie-client.svg?branch=master)](https://travis-ci.org/hoodiehq/hoodie-client)
    [![client coverage
    status](https://coveralls.io/repos/hoodiehq/hoodie-client/badge.svg?branch=master)](https://coveralls.io/r/hoodiehq/hoodie-client?branch=master)
    [![client dependency
    status](https://david-dm.org/hoodiehq/hoodie-client.svg)](https://david-dm.org/hoodiehq/hoodie-client)

    > Hoodie’s front-end client for the browser. It integrates Hoodie’s
    > client core modules:
    > [account-client](https://github.com/hoodiehq/hoodie-account-client),
    > [store-client](https://github.com/hoodiehq/hoodie-store-client),
    > [connection-status](https://github.com/hoodiehq/hoodie-connection-status)
    > and [log](https://github.com/hoodiehq/hoodie-log)
    >
    > 1.  account-client [![account-client
    >     repository](https://assets-cdn.github.com/images/icons/emoji/octocat.png)](https://github.com/hoodiehq/hoodie-account-client#readme)
    >     [![account-client build
    >     status](https://travis-ci.org/hoodiehq/hoodie-account-client.svg?branch=master)](https://travis-ci.org/hoodiehq/hoodie-account-client)
    >     [![account-client coverage
    >     status](https://coveralls.io/repos/hoodiehq/hoodie-account-client/badge.svg?branch=master)](https://coveralls.io/r/hoodiehq/hoodie-account-client?branch=master)
    >     [![account-client dependency
    >     status](https://david-dm.org/hoodiehq/hoodie-account-client.svg)](https://david-dm.org/hoodiehq/hoodie-account-client)
    >
    >     > Client for the [Account JSON
    >     > API](http://docs.accountjsonapi.apiary.io). It persists
    >     > session information on the client and provides front-end
    >     > friendly APIs for things like creating a user account,
    >     > confirming, resetting a password, changing profile
    >     > information, or closing the account.
    >
    > 2.  store-client [![store-client
    >     repository](https://assets-cdn.github.com/images/icons/emoji/octocat.png)](https://github.com/hoodiehq/hoodie-store-client#readme)
    >     [![store-client build
    >     status](https://travis-ci.org/hoodiehq/hoodie-store-client.svg?branch=master)](https://travis-ci.org/hoodiehq/hoodie-store-client)
    >     [![store-client coverage
    >     status](https://coveralls.io/repos/hoodiehq/hoodie-store-client/badge.svg?branch=master)](https://coveralls.io/r/hoodiehq/hoodie-store-client?branch=master)
    >     [![store-client dependency
    >     status](https://david-dm.org/hoodiehq/hoodie-store-client.svg)](https://david-dm.org/hoodiehq/hoodie-store-client)
    >
    >     > Store client for data persistence and offline sync. It
    >     > combines
    >     > [pouchdb-hoodie-api](https://github.com/hoodiehq/pouchdb-hoodie-api)
    >     > and
    >     > [pouchdb-hoodie-sync](https://github.com/hoodiehq/pouchdb-hoodie-sync).
    >
    >     1.  pouchdb-hoodie-api [![pouchdb-hoodie-api
    >         repository](https://assets-cdn.github.com/images/icons/emoji/octocat.png)](https://github.com/hoodiehq/pouchdb-hoodie-api#readme)
    >         [![pouchdb-hoodie-api build
    >         status](https://travis-ci.org/hoodiehq/pouchdb-hoodie-api.svg?branch=master)](https://travis-ci.org/hoodiehq/pouchdb-hoodie-api)
    >         [![pouchdb-hoodie-api coverage
    >         status](https://coveralls.io/repos/hoodiehq/pouchdb-hoodie-api/badge.svg?branch=master)](https://coveralls.io/r/hoodiehq/pouchdb-hoodie-api?branch=master)
    >         [![pouchdb-hoodie-api dependency
    >         status](https://david-dm.org/hoodiehq/pouchdb-hoodie-api.svg)](https://david-dm.org/hoodiehq/pouchdb-hoodie-api)
    >
    >         > [PouchDB](https://pouchdb.com) plugin that provides
    >         > simple methods to add, find, update and remove data.
    >
    >     2.  pouchdb-hoodie-sync [![pouchdb-hoodie-sync
    >         repository](https://assets-cdn.github.com/images/icons/emoji/octocat.png)](https://github.com/hoodiehq/pouchdb-hoodie-sync#readme)
    >         [![pouchdb-hoodie-sync build
    >         status](https://travis-ci.org/hoodiehq/pouchdb-hoodie-sync.svg?branch=master)](https://travis-ci.org/hoodiehq/pouchdb-hoodie-sync)
    >         [![pouchdb-hoodie-sync coverage
    >         status](https://coveralls.io/repos/hoodiehq/pouchdb-hoodie-sync/badge.svg?branch=master)](https://coveralls.io/r/hoodiehq/pouchdb-hoodie-sync?branch=master)
    >         [![pouchdb-hoodie-sync dependency
    >         status](https://david-dm.org/hoodiehq/pouchdb-hoodie-sync.svg)](https://david-dm.org/hoodiehq/pouchdb-hoodie-sync)
    >
    >         > [PouchDB](https://pouchdb.com) plugin that provides
    >         > simple methods to keep two databases in sync.
    >
    > 3.  connection-status [![connection-status
    >     repository](https://assets-cdn.github.com/images/icons/emoji/octocat.png)](https://github.com/hoodiehq/hoodie-connection-status#readme)
    >     [![connection-status build
    >     status](https://travis-ci.org/hoodiehq/hoodie-connection-status.svg?branch=master)](https://travis-ci.org/hoodiehq/hoodie-connection-status)
    >     [![connection-status coverage
    >     status](https://coveralls.io/repos/hoodiehq/hoodie-connection-status/badge.svg?branch=master)](https://coveralls.io/r/hoodiehq/hoodie-connection-status?branch=master)
    >     [![connection-status dependency
    >     status](https://david-dm.org/hoodiehq/hoodie-connection-status.svg)](https://david-dm.org/hoodiehq/hoodie-connection-status)
    >
    >     > Browser library to monitor a connection status. It emits
    >     > `disconnect` & `reconnect` events if the request status
    >     > changes and persists its status on the client.
    >
    > 4.  log [![log
    >     repository](https://assets-cdn.github.com/images/icons/emoji/octocat.png)](https://github.com/hoodiehq/hoodie-log#readme)
    >     [![log build
    >     status](https://travis-ci.org/hoodiehq/hoodie-log.svg?branch=master)](https://travis-ci.org/hoodiehq/hoodie-log)
    >     [![log coverage
    >     status](https://coveralls.io/repos/hoodiehq/hoodie-log/badge.svg?branch=master)](https://coveralls.io/r/hoodiehq/hoodie-log?branch=master)
    >     [![log dependency
    >     status](https://david-dm.org/hoodiehq/hoodie-log.svg)](https://david-dm.org/hoodiehq/hoodie-log)
    >
    >     > JavaScript library for logging to the browser console. If
    >     > available, it takes advantage of [CSS-based styling of
    >     > console log
    >     > outputs](https://developer.mozilla.org/en-US/docs/Web/API/Console#Styling_console_output).
    >
3.  admin [![admin
    repository](https://assets-cdn.github.com/images/icons/emoji/octocat.png)](https://github.com/hoodiehq/hoodie-admin#readme)
    [![admin build
    status](https://travis-ci.org/hoodiehq/hoodie-admin.svg?branch=master)](https://travis-ci.org/hoodiehq/hoodie-admin)
    [![admin dependency
    status](https://david-dm.org/hoodiehq/hoodie-admin.svg)](https://david-dm.org/hoodiehq/hoodie-admin)

    > Hoodie’s built-in Admin Dashboard, built with
    > [Ember.js](http://emberjs.com)
    >
    > 1.  admin-client [![admin-client
    >     repository](https://assets-cdn.github.com/images/icons/emoji/octocat.png)](https://github.com/hoodiehq/hoodie-admin-client#readme)
    >     [![admin-client build
    >     status](https://travis-ci.org/hoodiehq/hoodie-admin-client.svg?branch=master)](https://travis-ci.org/hoodiehq/hoodie-admin-client)
    >     [![admin-client coverage
    >     status](https://coveralls.io/repos/hoodiehq/hoodie-admin-client/badge.svg?branch=master)](https://coveralls.io/r/hoodiehq/hoodie-admin-client?branch=master)
    >     [![admin-client dependency
    >     status](https://david-dm.org/hoodiehq/hoodie-admin-client.svg)](https://david-dm.org/hoodiehq/hoodie-account-client)
    >
    >     > Hoodie’s front-end admin client for the browser. Used in the
    >     > Admin Dashboard, but can also be used standalone for custom
    >     > admin dashboard.
    >

